<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <p>
        Name:
        <input type="text " id="uname">
    </p>

    <p>
        userPad:
        <input type="password" id="pwd">
    </p>
    <p>
        email:
        <input type="email" id="uemail">
    </p>
    <p>
        tel:
        <input type="tel" id="utel">
    </p>
    <p>
        userName:
        <input type="text " id="user_name">
    </p>
    <p>
        gender :
        <select name="" id="ugender">
            <option value="">
                请选择：
            </option>
            <option value="1">
                男
            </option>
            <option value="0">
                女
            </option>
        </select>
    </p>
    <button id="btn">click me</button>
    <p id="demo"></p>
    <script>
        "use strict"
        // 将信息写入数据库
        btn.onclick = function () {
            var Xhr = new XMLHttpRequest();
            Xhr.onreadystatechange = function () {
                if (Xhr.readyState == 4 && Xhr.status == 200) {
                    var responseTXt = Xhr.responseText;
                    demo.innerHTML = responseTXt;
                    console.log(responseTXt)
                }
            }
            var uname = document.getElementById("uname").value;
            var upwd = pwd.value;
            var url = "http://192.168.33.132:83/ajax/register.php"
            var email = uemail.value;
            var tel = utel.value;
            var gender = ugender.value;
            var user_Name = user_name.value;
            // Xhr.open("GET",url,true);
            // Xhr.send(null);

            // post

            var msg = "uname=" + uname + "&upwd=" + upwd + "&uemail=" + email + "&utel=" +
                tel + "&user_name=" + user_Name + "&ugender=" + gender;
            Xhr.open("post", url, true)
            Xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            Xhr.send(msg);
        }
//          
//  检测数据库中用户名是否已经存在
        uname.onblur = function () {
            
            var Xhr = new XMLHttpRequest();
            Xhr.onreadystatechange = function () {
              
                if (Xhr.readyState == 4 && Xhr.status == 200) {
                    
                    var flag = Xhr.responseText;
                    // demo.innerHTML=flag;
                    if (flag == "1") {
                        demo.innerHTML = "该用户名已被使用，请重试";
                    } else if (flag == "0") {
                        demo.innerHTML = "用户名可用";
                    }
                }
            }
            var uname = document.getElementById("uname").value;
            var url = "http://192.168.33.132:83/ajax/check_uname.php"
            var msg = "uname=" + uname;
            Xhr.open("post", url, true);
            Xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            Xhr.send(msg);
        }


        

    </script>
</body>

</html>